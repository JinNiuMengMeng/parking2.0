webpackJsonp([2],{NAS8:function(e,t,n){"use strict";var o={deepClone:function(e){var t,n=this.getType(e);if("array"===n)t=[];else{if("object"!==n)return e;t={}}if("array"===n)for(var o=0,s=e.length;o<s;o++)t.push(this.deepClone(e[o]));else if("object"===n)for(var i in e)t[i]=this.deepClone(e[i]);return t},getType:function(e){return null===e?"null":void 0===e?"undefined":Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}};t.a=o},Ngmm:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n("NAS8");var o=n("N/5j"),s={data:function(){return{level:0,role_id:this.$store.getters.roleInfo.role_id,getRoleListUrl:httpConfig+"role/list",roleList:[],permisionList:[],defaultPermisionList:[],roleInfo:this.$store.getters.roleInfo,defaultProps:{children:"children",label:"name"}}},created:function(){this.getRoleList(),this.getPermisionList()},mounted:function(){},methods:{getRoleList:function(){var e=this;Object(o.a)({method:"post",url:httpConfig+"getallrole",data:{},done:function(t,n,o){t?e.$message.error(t.msg):(e.roleList=e.formateRoleList(n.role_list,null),e.level=n.role_level)},function:function(t){e.$message.error(t.msg)}})},getPermisionList:function(){var e=this;Object(o.a)({method:"post",url:httpConfig+"getrolepri",data:{role_id:e.role_id},done:function(t,n,o){t?e.$message.error(t.msg):(e.permisionList=n.pri_list,console.log(e.permisionList))},function:function(t){e.$message.error(t.msg)}})},formateRoleList:function(e,t){for(var n=[],o=void 0,s=0;s<e.length;s++)if(e[s].parent_id==t){var i=e[s];(o=this.formateRoleList(e,e[s].code)).length>0&&(i.children=o),n.push(i)}return n},handleNodeClick:function(e,t){this.role_id=e.code,console.log(e,t)},addRole:function(e,t){var n=this,s=this;this.$prompt("请输入角色名","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^.{1,20}$/,inputErrorMessage:"角色名格式不正确"}).then(function(n){var i=n.value,a={};a.name=i,a.parent_id=t.code,Object(o.a)({method:"post",url:httpConfig+"addrole",data:a,done:function(t,n,o){if(t)s.$message.error(t.msg);else{s.$message({type:"success",message:"新建角色名是: "+i});var a=n.code;s.appendRoleNode(e,a,i)}},function:function(e){s.$message({type:"error",message:e.msg})}})}).catch(function(){n.$message({type:"info",message:"取消输入"})})},appendRoleNode:function(e,t,n){var o={parent_id:e.data.code,code:t,name:n,children:[]};e.data.children||this.$set(e.data,"children",[]),e.data.children.push(o)},delRole:function(e,t){var n=this,s=this;this.$confirm("确认删除该角色?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(o.a)({method:"post",url:httpConfig+"delrole",data:{role_id:t.code},done:function(n,o,i){if(n)s.$message.error(n.msg);else{var a=e.parent,r=a.data.children||a.data,l=r.findIndex(function(e){return e.code===t.code});r.splice(l,1)}},function:function(e){s.$message.error(e.msg)}})}).catch(function(){n.$message({type:"info",message:"取消删除"})})},editRole:function(e,t){var n=this,s=this;this.$prompt("请输入修改角色名","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^.{1,20}$/,inputErrorMessage:"角色名格式不正确"}).then(function(n){var i=n.value,a={};a.name=i,a.role_id=t.code,Object(o.a)({method:"post",url:httpConfig+"editrole",data:a,done:function(t,n,o){t?s.$message.error(t.msg):(s.$message({type:"success",message:"修改角色名为: "+i}),e.data.name=i)},function:function(e){s.$message({type:"error",message:e.msg})}})}).catch(function(){n.$message({type:"info",message:"取消输入"})})}}},i={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{padding:"20px 40px"},attrs:{id:"role"}},[n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:8}},[n("div",{staticClass:"role-tree-container"},[n("div",{staticClass:"role-list"},[e._v("角色列表")]),e._v(" "),n("el-tree",{attrs:{"default-expand-all":"",data:e.roleList,props:e.defaultProps,"expand-on-click-node":!1},on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.node,s=t.data;return n("span",{staticClass:"custom-tree-node"},[n("span",[e._v(e._s(o.label))]),e._v(" "),n("span",{staticClass:"action-btn"},[n("button",{staticClass:"el-icon-circle-plus btn-add",attrs:{disabled:o.level+e.level===3},on:{click:function(t){t.stopPropagation(),e.addRole(o,s)}}}),e._v(" "),n("button",{staticClass:"el-icon-edit-outline btn-edit",attrs:{disabled:null==o.data.parent_id},on:{click:function(t){t.stopPropagation(),e.editRole(o,s)}}}),e._v(" "),n("button",{staticClass:"el-icon-circle-close btn-del",attrs:{disabled:null==o.data.parent_id},on:{click:function(t){t.stopPropagation(),e.delRole(o,s)}}})])])}}])})],1)]),e._v(" "),n("el-col",{attrs:{span:12}},[n("div",{staticClass:"role-tree-container"},[n("div",{staticClass:"role-list"},[e._v("权限列表")]),e._v(" "),n("el-tree",{attrs:{data:e.roleList,props:e.defaultProps,"node-key":"code","expand-on-click-node":!1},on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.node;return t.data,n("span",{staticClass:"custom-tree-node"},[n("span",[e._v(e._s(o.label))]),e._v(" "),n("span",{staticClass:"action-btn"},[n("button",{staticClass:"el-icon-circle-plus btn-add",on:{click:function(t){t.stopPropagation(),e.addRole(o)}}}),e._v(" "),n("button",{staticClass:"el-icon-edit-outline btn-edit",attrs:{disabled:""==o.data.parent_id},on:{click:function(t){t.stopPropagation(),e.editRole(o)}}}),e._v(" "),n("button",{staticClass:"el-icon-circle-close btn-del",attrs:{disabled:""==o.data.parent_id}})])])}}])})],1)])],1)],1)},staticRenderFns:[]};var a=n("C7Lr")(s,i,!1,function(e){n("uedg"),n("pMnS")},"data-v-b6fe0692",null);t.default=a.exports},pMnS:function(e,t){},uedg:function(e,t){}});
//# sourceMappingURL=2.df96f902f4c249aef79c.js.map