{"version":3,"sources":["webpack:///./src/js/deepclone.js","webpack:///src/components/permission/role.vue","webpack:///./src/components/permission/role.vue?0987","webpack:///./src/components/permission/role.vue"],"names":["deep","data","obj","type","this","getType","i","len","length","push","deepClone","key","undefined","Object","prototype","toString","call","slice","toLowerCase","role","level","role_id","$store","getters","roleInfo","getRoleListUrl","httpConfig","roleList","permisionList","defaultPermisionList","defaultProps","children","label","created","getRoleList","getPermisionList","mounted","methods","that","ajax","method","url","done","error","resdata","$message","msg","formateRoleList","role_list","role_level","function","pri_list","console","log","parent_id","newRoleList","temp","roleItem","code","handleNodeClick","node","addRole","_this","$prompt","confirmButtonText","cancelButtonText","inputPattern","inputErrorMessage","then","_ref","value","params","name","message","appendRoleNode","catch","newChild","$set","delRole","_this2","$confirm","ajaxData","parent","index","findIndex","d","splice","editRole","_this3","_ref2","permission_role","render","_vm","_h","$createElement","_c","_self","staticStyle","padding","attrs","id","gutter","span","staticClass","_v","default-expand-all","props","expand-on-click-node","on","node-click","scopedSlots","_u","fn","ref","_s","disabled","click","$event","stopPropagation","node-key","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/computer/js/2.df96f902f4c249aef79c.js","sourcesContent":["\r\n // 深克隆\r\n function deepClone (data) {\r\n  var type = this.getType(data);\r\n  var obj;\r\n  if(type === 'array'){\r\n      obj = [];\r\n  } else if(type === 'object'){\r\n      obj = {};\r\n  } else {\r\n  //不再具有下一层次\r\n  return data;\r\n  }\r\n  if(type === 'array'){\r\n  for(var i = 0, len = data.length; i < len; i++){\r\n      obj.push(this.deepClone(data[i]));\r\n  }\r\n  } else if(type === 'object'){\r\n  for(var key in data){\r\n      obj[key] = this.deepClone(data[key]);\r\n  }\r\n  }\r\n  return obj;\r\n}\r\n// 判断对象类型\r\n function getType (obj) {\r\n  if (obj === null) return 'null';\r\n  if (obj === undefined) return 'undefined';\r\n  return Object.prototype.toString.call(obj).slice(8,-1).toLowerCase();\r\n}\r\nvar deep={}\r\ndeep.deepClone=deepClone;\r\ndeep.getType=getType;\r\nexport default deep;\n\n\n// WEBPACK FOOTER //\n// ./src/js/deepclone.js","<template>\r\n\t<div id=\"role\" style=\"padding:20px 40px\">\r\n\t\t<el-row :gutter=\"20\">\r\n\t\t\t<el-col :span=\"8\" >\r\n\t\t\t\t<div class=\"role-tree-container\">\r\n\t\t\t\t\t<div class=\"role-list\">角色列表</div>\r\n\t\t\t\t\t<el-tree \r\n\t\t\t\t\t\tdefault-expand-all\r\n\t\t\t\t\t\t:data=\"roleList\" \r\n\t\t\t\t\t\t:props=\"defaultProps\" \r\n\t\t\t\t\t\t:expand-on-click-node=\"false\"\r\n\t\t\t\t\t\t@node-click=\"handleNodeClick\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t<span class=\"custom-tree-node\" slot-scope=\"{ node, data }\">\r\n\t\t\t\t\t\t\t<span>{{ node.label }}</span>\r\n\t\t\t\t\t\t\t<span class=\"action-btn\">\r\n\t\t\t\t\t\t\t\t<button class=\"el-icon-circle-plus btn-add\" \r\n\t\t\t\t\t\t\t\t\t:disabled=\"(node.level+level)===3\"\r\n\t\t\t\t\t\t\t\t  @click.stop=\"addRole(node,data)\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t<button  class=\"el-icon-edit-outline btn-edit\"\r\n\t\t\t\t\t\t\t\t\t:disabled='node.data.parent_id==null'\r\n\t\t\t\t\t\t\t\t\t@click.stop=\"editRole(node,data)\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t<button  class=\"el-icon-circle-close btn-del\"\r\n\t\t\t\t\t\t\t\t\t:disabled='node.data.parent_id==null'\r\n\t\t\t\t\t\t\t\t\t@click.stop=\"delRole(node,data)\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t</el-tree>\r\n\t\t\t\t</div>\r\n\t\t\t</el-col>\r\n\t\t\t<el-col :span=\"12\" >\r\n\t\t\t\t<div class=\"role-tree-container\">\r\n\t\t\t\t\t<div class=\"role-list\">权限列表</div>\r\n\t\t\t\t\t<el-tree \r\n\t\t\t\t\t\t:data=\"roleList\" \r\n\t\t\t\t\t\t:props=\"defaultProps\" \r\n\t\t\t\t\t\t node-key=\"code\"\r\n\t\t\t\t\t\t:expand-on-click-node=\"false\"\r\n\t\t\t\t\t\t@node-click=\"handleNodeClick\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t<span class=\"custom-tree-node\" slot-scope=\"{ node, data }\">\r\n\t\t\t\t\t\t\t<span>{{ node.label }}</span>\r\n\t\t\t\t\t\t\t<span class=\"action-btn\">\r\n\t\t\t\t\t\t\t\t<button class=\"el-icon-circle-plus btn-add\" \r\n\t\t\t\t\t\t\t\t\t  @click.stop=\"addRole(node)\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t<button  class=\"el-icon-edit-outline btn-edit\"\r\n\t\t\t\t\t\t\t\t\t:disabled='node.data.parent_id==\"\"'\r\n\t\t\t\t\t\t\t\t\t @click.stop=\"editRole(node)\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t<button  class=\"el-icon-circle-close btn-del\"\r\n\t\t\t\t\t\t\t\t\t:disabled='node.data.parent_id==\"\"'\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t</el-tree>\r\n\t\t\t\t</div>\r\n\t\t\t</el-col>\r\n\t\t</el-row>\r\n\t\t\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\nimport deep from '@/js/deepclone';\r\nimport {Ajax} from '@/js/ajax'\r\nexport default {\r\n\tdata () {\r\n\t\treturn {\r\n\t\t\t//角色层级 角色最多3层 0超级管理员 1一代级 2二代级\r\n\t\t\tlevel:0,\r\n\t\t\trole_id:this.$store.getters.roleInfo.role_id,\r\n\t\t\tgetRoleListUrl: httpConfig + 'role/list',\r\n\t\t\troleList:[],//角色列表\r\n\t\t\tpermisionList:[],//权限列表\r\n\t\t\tdefaultPermisionList:[],\r\n\t\t\troleInfo:this.$store.getters.roleInfo,\r\n\t\t\tdefaultProps: {\r\n\t\t\t\tchildren: 'children',\r\n\t\t\t\tlabel: 'name'\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tcreated () {\r\n\t\tthis.getRoleList();\r\n\t\tthis.getPermisionList();\r\n\t\t// console.log(this.roleInfo)\r\n\t\r\n\t},\r\n\tmounted () {\r\n\r\n\t},\r\n\tmethods: {\r\n\t\t\t// 获取角色列表数据\r\n\t\t\tgetRoleList () {\r\n\t\t\t\tlet that = this;\r\n\t\t\t\tAjax({\r\n          method:'post',\r\n\t\t\t\t\turl : httpConfig+'getallrole',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdone: function(error,data,resdata) {\r\n\t\t\t\t\t\tif(error){\r\n\t\t\t\t\t\t\tthat.$message.error(error.msg);\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tthat.roleList = that.formateRoleList(data.role_list,null);\r\n\t\t\t\t\t\t\tthat.level=data.role_level;\r\n\t\t\t\t\t\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}, function(error) {\r\n\t\t\t\t\t\tthat.$message.error(error.msg);\r\n\t\t\t\t\t}\t\r\n        })\r\n\t\t\t},\r\n\t\t\t//获取权限列表数据\r\n\t\t\tgetPermisionList(){\r\n\t\t\t\tlet that = this;\r\n\t\t\t\tAjax({\r\n          method:'post',\r\n\t\t\t\t\turl : httpConfig+'getrolepri',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\trole_id:that.role_id\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdone: function(error,data,resdata) {\r\n\t\t\t\t\t\tif(error){\r\n\t\t\t\t\t\t\tthat.$message.error(error.msg);\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tthat.permisionList = data.pri_list;\r\n\t\t\t\t\t\t\tconsole.log(that.permisionList)\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}, function(error) {\r\n\t\t\t\t\t\tthat.$message.error(error.msg);\r\n\t\t\t\t\t}\t\r\n        })\r\n\t\t\t},\r\n\t\t// 将角色列表数据渲染成要的数据格式\r\n\t\t\tformateRoleList (roleList, parent_id) {\r\n\t\t\t\tlet newRoleList = [];\r\n        let temp;\r\n        for (let i = 0; i < roleList.length; i++) {\r\n          if (roleList[i].parent_id == parent_id) {\r\n            let roleItem = roleList[i];\r\n            temp =this.formateRoleList(roleList, roleList[i].code);\r\n            if (temp.length > 0) {\r\n            \troleItem.children = temp;\r\n            }\r\n            newRoleList.push(roleItem);\r\n          }\r\n        }\r\n        return newRoleList;\r\n\t\t\t},\r\n\t\t\t//树节点点击事件\r\n\t\t\thandleNodeClick(data,node){\r\n\t\t\t\tthis.role_id=data.code;\r\n\t\t\t\t console.log(data,node);\r\n\t\t\t},\r\n\t\t\taddRole(node,data){\r\n\t\t\t\tlet that=this;\r\n\t\t\t\t// console.log(node)\r\n\t\t\t\tthis.$prompt('请输入角色名', '提示', {\r\n\t\t\t\t\tconfirmButtonText: '确定',\r\n\t\t\t\t\tcancelButtonText: '取消',\r\n\t\t\t\t\tinputPattern: /^.{1,20}$/,\r\n\t\t\t\t\tinputErrorMessage: '角色名格式不正确'\r\n        }).then(({ value }) => {\r\n\t\t\t\t\tlet params={};\r\n\t\t\t\t\tparams.name=value;\r\n\t\t\t\t\tparams.parent_id=data.code;\r\n\t\t\t\t\tAjax({\r\n\t\t\t\t\t\tmethod:'post',\r\n\t\t\t\t\t\turl : httpConfig+'addrole',\r\n\t\t\t\t\t\tdata: params,\r\n\t\t\t\t\t\tdone: function(error,data,resdata) {\r\n\t\t\t\t\t\t\tif(error){\r\n\t\t\t\t\t\t\t\tthat.$message.error(error.msg);\r\n\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\tthat.$message({\r\n\t\t\t\t\t\t\t\t\ttype: 'success',\r\n\t\t\t\t\t\t\t\t\tmessage: '新建角色名是: ' + value\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tlet code=data.code;\r\n\t\t\t\t\t\t\t\tthat.appendRoleNode(node,code,value);\r\n\t\t\t\t\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t}, function(error) {\r\n\t\t\t\t\t\t\t that.$message({\r\n\t\t\t\t\t\t\t\t\ttype: 'error',\r\n\t\t\t\t\t\t\t\t\tmessage: error.msg\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\t\r\n\t\t\t\t\t})\r\n         \r\n        }).catch(() => {\r\n          this.$message({\r\n            type: 'info',\r\n            message: '取消输入'\r\n          });       \r\n        });\r\n\t\t\t},\r\n\t\t\tappendRoleNode(node,code,value){\r\n\t\t\t\t// console.log(node,code,value)\r\n\t\t\t\tlet that = this;\r\n\t\t\t\tconst newChild = { parent_id:node.data.code,code: code, name: value, children: [] };\r\n\t\t\t\tif (!node.data.children) {\r\n\t\t\t\t\tthis.$set(node.data, 'children', []);\r\n\t\t\t\t}\r\n\t\t\t\tnode.data.children.push(newChild);\r\n\t\t\t},\r\n\t\t\tdelRole(node,data){\r\n\t\t\t\tlet that = this;\r\n\t\t\t\tthis.$confirm('确认删除该角色?', '提示', {\r\n          confirmButtonText: '确定',\r\n          cancelButtonText: '取消',\r\n          type: 'warning'\r\n        }).then(() => {\r\n          Ajax({\r\n\t          method:'post',\r\n\t\t\t\t\t\turl: httpConfig+'delrole',\r\n\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\trole_id: data.code\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tdone: function(error,ajaxData,resdata) {\r\n\t\t\t\t\t\t\tif(error){\r\n\t\t\t\t\t\t\t\tthat.$message.error(error.msg);\r\n\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\tconst parent = node.parent;\r\n\t\t\t\t        const children = parent.data.children || parent.data;\r\n\t\t\t\t\t\t\t\tconst index = children.findIndex(d => d.code === data.code);\r\n\t\t\t\t\t\t\t\t// console.log(children);\r\n\t\t\t\t        children.splice(index, 1);\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t}, function(error) {\r\n\t\t\t\t\t\t\tthat.$message.error(error.msg);\r\n\t\t\t\t\t\t}\t\r\n\t        })\r\n        }).catch(() => {\r\n\t\t\t\t\tthis.$message({\r\n            type: 'info',\r\n            message: '取消删除'\r\n          });     \r\n        });\r\n\t\t\t},\r\n\t\t\teditRole(node,data){\r\n\t\t\t\tlet that=this;\r\n\t\t\t\tthis.$prompt('请输入修改角色名', '提示', {\r\n\t\t\t\t\tconfirmButtonText: '确定',\r\n\t\t\t\t\tcancelButtonText: '取消',\r\n\t\t\t\t\tinputPattern: /^.{1,20}$/,\r\n\t\t\t\t\tinputErrorMessage: '角色名格式不正确'\r\n        }).then(({ value }) => {\r\n\t\t\t\t\tlet params={};\r\n\t\t\t\t\tparams.name=value;\r\n\t\t\t\t\tparams.role_id=data.code;\r\n\t\t\t\t\tAjax({\r\n\t\t\t\t\t\tmethod:'post',\r\n\t\t\t\t\t\turl : httpConfig+'editrole',\r\n\t\t\t\t\t\tdata: params,\r\n\t\t\t\t\t\tdone: function(error,data,resdata) {\r\n\t\t\t\t\t\t\tif(error){\r\n\t\t\t\t\t\t\t\tthat.$message.error(error.msg);\r\n\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\tthat.$message({\r\n\t\t\t\t\t\t\t\t\ttype: 'success',\r\n\t\t\t\t\t\t\t\t\tmessage: '修改角色名为: ' + value\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t// let code=data.code;\r\n\t\t\t\t\t\t\t\t// that.appendRoleNode(node,code,value);\r\n\t\t\t\t\t\t\t\tnode.data.name=value;\r\n\t\t\t\t\t\t\t\t// console.log(node)\r\n\t\t\t\t\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t}, function(error) {\r\n\t\t\t\t\t\t\t that.$message({\r\n\t\t\t\t\t\t\t\t\ttype: 'error',\r\n\t\t\t\t\t\t\t\t\tmessage: error.msg\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\t\r\n\t\t\t\t\t})\r\n         \r\n        }).catch(() => {\r\n          this.$message({\r\n            type: 'info',\r\n            message: '取消输入'\r\n          });       \r\n        });\r\n\t\t\t}\r\n\t\t\t\r\n\t}\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped src=\"@/styles/permission/role.scss\"></style>\r\n\r\n<style >\r\n\t.el-tree-node__content{\r\n\theight:35px;\r\n}\r\n</style>\n\n\n// WEBPACK FOOTER //\n// src/components/permission/role.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticStyle:{\"padding\":\"20px 40px\"},attrs:{\"id\":\"role\"}},[_c('el-row',{attrs:{\"gutter\":20}},[_c('el-col',{attrs:{\"span\":8}},[_c('div',{staticClass:\"role-tree-container\"},[_c('div',{staticClass:\"role-list\"},[_vm._v(\"角色列表\")]),_vm._v(\" \"),_c('el-tree',{attrs:{\"default-expand-all\":\"\",\"data\":_vm.roleList,\"props\":_vm.defaultProps,\"expand-on-click-node\":false},on:{\"node-click\":_vm.handleNodeClick},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar node = ref.node;\nvar data = ref.data;\nreturn _c('span',{staticClass:\"custom-tree-node\"},[_c('span',[_vm._v(_vm._s(node.label))]),_vm._v(\" \"),_c('span',{staticClass:\"action-btn\"},[_c('button',{staticClass:\"el-icon-circle-plus btn-add\",attrs:{\"disabled\":(node.level+_vm.level)===3},on:{\"click\":function($event){$event.stopPropagation();_vm.addRole(node,data)}}}),_vm._v(\" \"),_c('button',{staticClass:\"el-icon-edit-outline btn-edit\",attrs:{\"disabled\":node.data.parent_id==null},on:{\"click\":function($event){$event.stopPropagation();_vm.editRole(node,data)}}}),_vm._v(\" \"),_c('button',{staticClass:\"el-icon-circle-close btn-del\",attrs:{\"disabled\":node.data.parent_id==null},on:{\"click\":function($event){$event.stopPropagation();_vm.delRole(node,data)}}})])])}}])})],1)]),_vm._v(\" \"),_c('el-col',{attrs:{\"span\":12}},[_c('div',{staticClass:\"role-tree-container\"},[_c('div',{staticClass:\"role-list\"},[_vm._v(\"权限列表\")]),_vm._v(\" \"),_c('el-tree',{attrs:{\"data\":_vm.roleList,\"props\":_vm.defaultProps,\"node-key\":\"code\",\"expand-on-click-node\":false},on:{\"node-click\":_vm.handleNodeClick},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar node = ref.node;\nvar data = ref.data;\nreturn _c('span',{staticClass:\"custom-tree-node\"},[_c('span',[_vm._v(_vm._s(node.label))]),_vm._v(\" \"),_c('span',{staticClass:\"action-btn\"},[_c('button',{staticClass:\"el-icon-circle-plus btn-add\",on:{\"click\":function($event){$event.stopPropagation();_vm.addRole(node)}}}),_vm._v(\" \"),_c('button',{staticClass:\"el-icon-edit-outline btn-edit\",attrs:{\"disabled\":node.data.parent_id==\"\"},on:{\"click\":function($event){$event.stopPropagation();_vm.editRole(node)}}}),_vm._v(\" \"),_c('button',{staticClass:\"el-icon-circle-close btn-del\",attrs:{\"disabled\":node.data.parent_id==\"\"}})])])}}])})],1)])],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler?{\"id\":\"data-v-b6fe0692\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.7.3@vue-loader/lib/selector.js?type=template&index=0!./src/components/permission/role.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-b6fe0692\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!px2rem-loader?{\\\"remUnit\\\":192}!sass-loader?{\\\"sourceMap\\\":true}!sass-resources-loader?{\\\"resources\\\":\\\"G:\\\\\\\\云停\\\\\\\\src\\\\\\\\common\\\\\\\\styles\\\\\\\\index.scss\\\"}!@/styles/permission/role.scss\")\n  require(\"!!../../../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-b6fe0692\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!px2rem-loader?{\\\"remUnit\\\":192}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=styles&index=1!./role.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./role.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./role.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-b6fe0692\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=template&index=0!./role.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-b6fe0692\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/permission/role.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}